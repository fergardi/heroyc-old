extends layout

block content
  div#forge
    .row
      .col-xs-12
        .page-header
          h1 Forge 
            small Create things
      .col-md-3.col-xs-12(v-for='recipe in recipes')
        .panel.text-center(v-bind:class='"panel-" + recipe.Result.rarity')
          .panel-heading
            .panel-title
              i.fa.fa-fw.fa-lg(v-bind:class='"fa-" + recipe.Result.icon')  
              span {{recipe.Result.name}}
          .panel-body
            .row
              .col-xs-6
                img.thumbnail(v-bind:src='"/images/items/" + recipe.Original.type + "/" + recipe.Original.image + ".png"', v-bind:class='"panel-" + recipe.Original.rarity', data-toggle='tooltip', v-bind:title='recipe.Original.name')
              .col-xs-6
                img.thumbnail(v-bind:src='"/images/resources/" + recipe.Resource.image + ".png"', v-bind:class='"panel-" + recipe.Resource.family', data-toggle='tooltip', v-bind:title='recipe.Resource.name')
            .row
              .col-xs-12
                img.thumbnail.slot(v-bind:src='"/images/items/" + recipe.Result.type + "/" + recipe.Result.image + ".png"', v-bind:class='"panel-" + recipe.Result.rarity', data-toggle='tooltip', v-bind:title='recipe.Result.name')
          .panel-body
            button.btn.btn-success.btn-block
              +fa('check') Forge
        
block javascripts
  script.
    var forge = new Vue({
      el: '#forge',
      data: {
        filter: '',
        recipes: []
      },
      mounted: function() {
        self = this;
        self.get();
      },
      methods: {
        get: function() {
          $.get('/api/recipe', function(results) {
            self.recipes = results.data;
            console.log(self.recipes);
            notification.info('Items loaded from database!')
          });
        },
        reset: function() {
          self.filter = '';
        }
      },
      computed: {
        filtered: function() {
          return this.recipes.filter(function(recipe) {
            return recipe.Result.name.toLowerCase().indexOf(self.filter.toLowerCase()) !== -1;
          });
        }
      }
    });